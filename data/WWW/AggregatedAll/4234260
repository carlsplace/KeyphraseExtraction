Enforcing_VBG strict_JJ model-view_JJ separation_NN in_IN template_NN engines_NNS
The_DT mantra_NN of_IN every_DT experienced_JJ web_NN application_NN developer_NN is_VBZ the_DT same_JJ :_: thou_FW shalt_FW separate_JJ business_NN logic_NN from_IN display_NN ._.
Ironically_RB ,_, almost_RB all_DT template_NN engines_NNS allow_VBP violation_NN of_IN this_DT separation_NN principle_NN ,_, which_WDT is_VBZ the_DT very_JJ impetus_NN for_IN HTML_NNP template_NN engine_NN development_NN ._.
This_DT situation_NN is_VBZ due_JJ mostly_RB to_TO a_DT lack_NN of_IN formal_JJ definition_NN of_IN separation_NN and_CC fear_VBP that_IN enforcing_VBG separation_NN emasculates_VBZ a_DT template_NN 's_POS power_NN ._.
I_PRP show_VBP that_IN not_RB only_RB is_VBZ strict_JJ separation_NN a_DT worthy_JJ design_NN principle_NN ,_, but_CC that_IN we_PRP can_MD enforce_VB separation_NN while_IN providing_VBG a_DT potent_JJ template_NN engine_NN ._.
I_PRP demonstrate_VBP my_PRP$ StringTemplate_NNP engine_NN ,_, used_VBN to_TO build_VB jGuru.com_NN and_CC other_JJ commercial_JJ sites_NNS ,_, at_IN work_NN solving_VBG some_DT nontrivial_JJ generational_JJ tasks_NNS ._.
My_PRP$ goal_NN is_VBZ to_TO formalize_VB the_DT study_NN of_IN template_NN engines_NNS ,_, thus_RB ,_, providing_VBG a_DT common_JJ nomenclature_NN ,_, a_DT means_NN of_IN classifying_VBG template_NN generational_JJ power_NN ,_, and_CC a_DT way_NN to_TO leverage_NN interesting_JJ results_NNS from_IN formal_JJ language_NN theory_NN ._.
I_PRP classify_VBP three_CD types_NNS of_IN restricted_JJ templates_NNS analogous_JJ to_TO Chomsky_NNP 's_POS type_NN 1_CD ._.
.3_NN grammar_NN classes_NNS and_CC formally_RB define_VB separation_NN including_VBG the_DT rules_NNS that_WDT embody_VBP separation_NN ._.
Because_IN this_DT paper_NN provides_VBZ a_DT clear_JJ definition_NN of_IN model-view_JJ separation_NN ,_, template_NN engine_NN designers_NNS may_MD no_RB longer_RBR blindly_RB claim_VBP enforcement_NN of_IN separation_NN ._.
Moreover_RB ,_, given_VBN theoretical_JJ arguments_NNS and_CC empirical_JJ evidence_NN ,_, programmers_NNS no_RB longer_RB have_VB an_DT excuse_NN to_TO entangle_VB model_NN and_CC view_NN ._.
an_DT AST-producing_JJ parser_NN ,_, an_DT application_NN can_MD also_RB isolate_VB all_DT of_IN the_DT semantics_NNS in_IN one_CD or_CC more_JJR tree_NN walking_NN phases_NNS ._.
ANTLR_NN -LRB-_-LRB- 8_CD -RRB-_-RRB- provides_VBZ tree_NN grammars_NNS with_IN rewrite_VBP rules_NNS and_CC integrates_VBZ the_DT StringTemplate_NN =_JJ -_: =[_NN 7_CD -RRB-_-RRB- -_: =_JJ -_: template_NN engine_NN ._.
This_DT decoupled_VBN approach_NN only_RB supports_VBZ verbatim_JJ syntax_NN grammar_NN reuse_NN when_WRB the_DT new_JJ application_NN needs_VBZ the_DT exact_JJ same_JJ language_NN -LRB-_-LRB- and_CC same_JJ AST_NNP structure_NN ,_, if_IN using_VBG AST_NNP rewrites_NNS or_CC walking_NN -RRB-_-RRB- ._.
to_TO the_DT template_NN to_TO create_VB the_DT web_NN page_NN ._.
The_DT ESCUDO_NN configuration_NN can_MD be_VB specified_VBN in_IN the_DT template_NN ,_, isolating_VBG the_DT configuration_NN from_IN dynamic_JJ data_NNS ._.
Sophisticated_JJ template_NN engines_NNS such_JJ as_IN StringTemplate_NN =_JJ -_: =[_NN 29_CD -RRB-_-RRB- -_: =_SYM -_: provide_VBP a_DT stricter_JJR separation_NN between_IN view_NN and_CC model_NN ,_, making_VBG it_PRP easy_JJ to_TO manage_VB ESCUDO_NNP configurations_NNS for_IN largescale_JJ web_NN applications_NNS ._.
Language-based_JJ information_NN flow_NN could_MD also_RB be_VB used_VBN to_TO create_VB ESCU_NN
nd_IN personal_JJ use_NN by_IN others_NNS ._.
WWW_NN 2009_CD ,_, April_NNP 20_CD --_: 24_CD ,_, 2009_CD ,_, Madrid_NNP ,_, Spain_NNP ._.
ACM_NN 978-1-60558-487-4_CD \/_: 09\/04_CD ._.
1_CD ._.
INTRODUCTION_NN Web_NN applications_NNS often_RB implement_VBP the_DT advantageous_JJ modelview-controller_JJ architecture_NN =_JJ -_: =[_NN 20_CD ,_, 11_CD -RRB-_-RRB- -_: =_SYM -_: by_IN using_VBG HTML_NNP templates_NNS ,_, often_RB seeking_VBG to_TO separate_VB the_DT webpage_NN presentation_NN from_IN the_DT business_NN logic_NN and_CC objects_NNS ._.
This_DT is_VBZ a_DT mantra_NN for_IN experienced_JJ Web_NN application_NN developers_NNS conforming_VBG to_TO that_DT archite_NN
running_VBG within_IN the_DT same_JJ memory_NN space_NN ,_, access_NN to_TO the_DT structure_NN with_IN chunks_NNS of_IN code_NN is_VBZ quick_JJ ,_, as_IN it_PRP also_RB functions_VBZ as_IN a_DT cache_NN ._.
An_DT important_JJ principle_NN is_VBZ the_DT separation_NN of_IN data_NNS processing_NN and_CC formatting_NN =_JJ -_: =[_NN 5_CD -RRB-_-RRB- -_: =_SYM -_: ._.
The_DT wpart_JJ syntax_NN forces_VBZ a_DT strict_JJ separation_NN of_IN the_DT model_NN and_CC the_DT view_NN in_IN applications_NNS ._.
This_DT allows_VBZ web_NN designers_NNS to_TO focus_VB on_IN creating_VBG HTML_NNP markup_NN ,_, while_IN the_DT Erlang_NNP developers_NNS can_MD focus_VB on_IN the_DT back-e_NN
stion_NN from_IN a_DT parameter_NN in_IN the_DT HTTP_NNP URI_NNP to_TO a_DT variable_NN ._.
In_IN a_DT scenario_NN without_IN Smarty_NNP ,_, View_NNP and_CC Model_NNP are_VBP mixed_JJ ._.
This_DT would_MD not_RB only_RB dismiss_VB the_DT design_NN pattern_NN but_CC also_RB reduce_VB reusability_NN of_IN source_NN code_NN =_JJ -_: =_JJ -LRB-_-LRB- Par04_NN -RRB-_-RRB- -_: =_SYM -_: ._.
The_DT use_NN of_IN Smarty_NNP contrasts_VBZ the_DT design_NN goal_NN PHP_NN originally_RB implements_VBZ ._.
In_IN fact_NN Smarty_NNP only_RB acts_VBZ as_IN a_DT layer_NN within_IN a_DT PHP_NNP script_NN --_: this_DT is_VBZ quite_RB obvious_JJ as_IN it_PRP is_VBZ coded_VBN in_IN PHP_NNP itself_PRP ._.
s34_NN CHAPTER_NN 4_CD ._.
TOO_NN
template_NN engine_NN StringTemplate_NN -LRB-_-LRB- 18_CD -RRB-_-RRB- for_IN template_NN expansion_NN ,_, which_WDT enforces_VBZ a_DT strict_JJ separation_NN of_IN generation_NN logic_NN and_CC template_NN definition_NN by_IN providing_VBG a_DT template_NN language_NN for_IN context-free_JJ templates_NNS =_JJ -_: =[_NN 19_CD -RRB-_-RRB- -_: =_SYM -_: ._.
This_DT interesting_JJ property_NN of_IN the_DT template_NN engine_NN and_CC the_DT abstract_JJ notion_NN of_IN Guides_NNP allows_VBZ us_PRP to_TO build_VB a_DT code_NN generator_NN that_WDT is_VBZ independent_JJ of_IN concrete_JJ query_NN languages_NNS ._.
3_CD Applications_NNS To_TO show_VB the_DT app_NN
t_NN strictly_RB enforces_VBZ model-view_JJ separation_NN has_VBZ been_VBN shown_VBN to_TO be_VB at_IN least_JJS as_RB expressive_JJ as_IN a_DT context_NN free_JJ grammar_NN allowing_VBG the_DT engine_NN to_TO ,_, for_IN example_NN ,_, easily_RB generate_VB any_DT file_NN describable_JJ by_IN an_DT XML_NN DTD_NN =_JJ -_: =[_NN 7_CD -RRB-_-RRB- -_: =_SYM -_: ._.
When_WRB faced_VBN with_IN supporting_NN internationalized_VBD web_NN applications_NNS ,_, however_RB ,_, template_NN engine_NN designers_NNS have_VBP backed_VBN off_RP from_IN enforcing_VBG strict_JJ separation_NN ,_, allowing_VBG unrestricted_JJ embedded_JJ code_NN segments_NNS becau_VBP
the_DT template_NN and_CC requiring_VBG side-effect_JJ free_JJ attribute_NN expressions_NNS ._.
Surprisingly_RB such_JJ restricted_JJ templates_NNS are_VBP easily_RB shown_VBN to_TO generate_VB the_DT context-free_JJ languages_NNS and_CC beyond_IN into_IN the_DT contextsensitive_NN =_JJ -_: =[_NN 18_CD -RRB-_-RRB- -_: =_SYM -_: ._.
By_IN limiting_VBG expressions_NNS to_TO be_VB simple_JJ side-effect_JJ free_JJ attribute_NN references_NNS ,_, one_PRP may_MD equate_VB attribute_NN expressions_NNS to_TO token_JJ references_NNS and_CC nested_JJ templates_NNS to_TO nested_JJ rule_NN invocations_NNS ._.
Strict_JJ model-vie_NN
View_NNP Controller_NNP for_IN Browsers_NNP The_NNP Model-View-Controller_NNP -LRB-_-LRB- MVC_NNP -RRB-_-RRB- design_NN pattern_NN separates_VBZ an_DT application_NN into_IN model_NN ,_, view_NN ,_, and_CC controller_NN components_NNS as_IN a_DT means_NN to_TO build_VB maintainable_JJ and_CC robust_JJ code_NN -LRB-_-LRB- 2_CD -RRB-_-RRB- -LRB-_-LRB- 3_LS -RRB-_-RRB- =_JJ -_: =[_NN 21_CD -RRB-_-RRB- -_: =_SYM -_: ._.
In_IN MVC_NNP ,_, the_DT model_NN can_MD be_VB thought_VBN of_IN as_IN application_NN data_NNS ,_, the_DT view_NN is_VBZ the_DT user_NN interface_NN for_IN interacting_VBG with_IN the_DT model_NN ,_, and_CC the_DT controller_NN processes_VBZ user_NN events_NNS from_IN the_DT view_NN to_TO update_VB both_CC the_DT mode_NN
ed_VBN to_TO a_DT template_NN ,_, the_DT template_NN engine_NN implicitly_RB calls_VBZ the_DT attribute_NN 's_POS toString_NN -LRB-_-LRB- -RRB-_-RRB- method_NN with_IN our_PRP$ tacit_JJ approval_NN ._.
The_DT collection_NN of_IN toString_NN -LRB-_-LRB- -RRB-_-RRB- methods_NNS of_IN all_DT incoming_JJ attribute_NN types_NNS embody_VBP an_DT aspect_NN =_JJ -_: =[_NN 7_CD -RRB-_-RRB- -_: =_JJ -_: ,_, perhaps_RB suggesting_VBG a_DT more_RBR complete_JJ design_NN pattern_NN name_NN when_WRB referring_VBG to_TO HTML_NNP page_NN generation_NN :_: MVCR_NN -LRB-_-LRB- model-view-controller-renderer_NN -RRB-_-RRB- where_WRB the_DT renderer_NN encapsulates_VBZ the_DT conversion_NN of_IN objects_NNS to_TO disp_VB
un_NN and_CC result_VBP in_IN much_RB more_RBR flexible_JJ ,_, robust_JJ code_NN specifically_RB because_IN of_IN the_DT significant_JJ benefits_NNS listed_VBN in_IN this_DT section_NN ._.
4_LS ._.
MODEL_NNP VIEW_NNP CONTROLLER_NNP PATTERN_NNP The_DT well-known_JJ model-view-controller_JJ pattern_NN =_JJ -_: =[_NN 9_CD -RRB-_-RRB- -_: =_SYM -_: applies_VBZ nicely_RB to_TO web_NN server_NN design_NN and_CC identifies_VBZ three_CD general_JJ ``_`` realms_NNS ''_'' where_WRB various_JJ pieces_NNS of_IN the_DT page_NN generation_NN process_NN belong_VB ._.
At_IN the_DT coarsest_JJS level_NN ,_, the_DT view_NN represents_VBZ a_DT page_NN 's_POS template_NN or_CC t_NN
s_NN and_CC by_IN design_NN ,_, as_IN shown_VBN in_IN section_NN 8_CD ,_, enforces_VBZ strict_JJ separation_NN of_IN model_NN and_CC view_NN ._.
This_DT section_NN defines_VBZ restricted_JJ classes_NNS of_IN templates_NNS corresponding_VBG to_TO the_DT Chomsky_NNP type_NN 1_CD ._.
.3_NN generational_JJ grammars_NNS =_JJ -_: =[_NN 1_CD -RRB-_-RRB- -_: =_JJ -_: :_: contextsensitive_JJ ,_, context-free_JJ ,_, and_CC regular_JJ ._.
Let_NNP 's_POS start_NN with_IN the_DT weakest_JJS template_NN class_NN ,_, type_NN 3_CD regular_JJ grammars_NNS -LRB-_-LRB- 16_CD -RRB-_-RRB- ._.
DEFINITION_NN 2_CD ._.
A_DT regular_JJ template_NN is_VBZ restricted_JJ to_TO 0_CD ,_, 1_CD ,_, or_CC 2_CD symbols_NNS ._.
The_DT firs_NNS
,_, in_FW answerto_FW the_DT second_JJ question_NN regarding_VBG usefulness_NN ,_, yes_RB :_: a_DT model-view_JJ duo_NN achieves_VBZ essentially_RB unrestricted_JJ power_NN without_IN violating_VBG any_DT rules_NNS of_IN separation_NN ._.
8.1_CD Attribute_NNP Rendering_NNP Benjamin_NNP Geer_NNP =_SYM -_: =[_NN 4_CD -RRB-_-RRB- -_: =_JJ -_: ,_, the_DT original_JJ author_NN of_IN FreeMarker_NN -LRB-_-LRB- 3_CD -RRB-_-RRB- ,_, posed_VBD a_DT seemingly_RB unresolvable_JJ conundrum_NN for_IN an_DT engine_NN enforcing_VBG separation_NN ._.
Consider_VB the_DT escape_NN of_IN ``_`` -LRB-_-LRB- ''_'' characters_NNS to_TO HTML_NNP format_NN ,_, ``_`` -LRB-_-LRB- ''_'' ,_, exemplifying_VBG a_DT commo_NN
iented_JJ design_NN ._.
For_IN example_NN ,_, an_DT include_VBP file_NN is_VBZ a_DT poor_JJ substitute_NN for_IN class_NN inheritance_NN ._.
JSP_NNP pages_NNS may_MD not_RB be_VB subclassed_VBN ,_, which_WDT makes_VBZ it_PRP hard_JJ for_IN programmers_NNS to_TO factor_VB out_RP common_JJ code_NN and_CC HTML_NNP ._.
Hunter_NNP =_SYM -_: =[_NN 5_CD -RRB-_-RRB- -_: =_SYM -_: summarizes_VBZ a_DT few_JJ other_JJ problems_NNS with_IN JSP_NNP such_JJ as_IN JSP_NNP 's_POS inelegant_JJ looping_JJ mechanism_NN to_TO display_NN lists_NNS ._.
While_IN JSP_NNP was_VBD not_RB the_DT answer_NN ,_, it_PRP did_VBD put_VB the_DT idea_NN of_IN a_DT template_NN into_IN programmers_NNS '_POS minds_NNS ._.
A_DT templat_NN
s_NN -LRB-_-LRB- rules_NNS -RRB-_-RRB- ._.
This_DT connection_NN yields_VBZ some_DT interesting_JJ and_CC useful_JJ results_NNS by_IN leveraging_VBG work_NN from_IN formal_JJ languages_NNS ._.
For_IN example_NN ,_, XML_NN document_NN type_NN definitions_NNS -LRB-_-LRB- DTDs_NNS -RRB-_-RRB- are_VBP essentially_RB context-free_JJ grammars_NNS =_JJ -_: =[_NN 8_CD -RRB-_-RRB- -_: =_JJ -_: ,_, therefore_RB ,_, a_DT template_NN with_IN the_DT power_NN of_IN a_DT context-free_JJ grammar_NN can_MD generate_VB any_DT XML_NN document_NN definable_JJ with_IN a_DT DTD_NNP ._.
It_PRP is_VBZ satisfying_JJ to_TO note_VB that_IN a_DT very_RB simple_JJ template_NN engine_NN emulating_VBG a_DT push_NN down_IN a_DT
mplate_VB via_IN attributes_NNS ._.
Once_RB in_IN the_DT model_NN ,_, computations_NNS are_VBP unrestricted_JJ ,_, therefore_RB ,_, template_NN power_NN moves_VBZ directly_RB from_IN the_DT context-free_JJ class_NN to_TO the_DT unrestricted_JJ class_NN in_IN practice_NN ._.
Milton_NNP and_CC Fischer_NNP =_SYM -_: =[_NN 11_CD -RRB-_-RRB- -_: =_SYM -_: claim_VBP an_DT analogous_JJ result_NN that_IN their_PRP$ predicated_VBN LL_NN -LRB-_-LRB- k_NN -RRB-_-RRB- parsers_NNS are_VBP Turing_VBG complete_JJ because_IN any_DT predicate_NN is_VBZ Turing_VBG complete_JJ ._.
In_IN the_DT next_JJ section_NN ,_, I_PRP lay_VBD out_RP the_DT strict_JJ rules_NNS of_IN separation_NN and_CC illustrat_NN
ike_NN behavior_NN is_VBZ insufficient_JJ ._.
My_PRP$ philosophy_NN with_IN StringTemplate_NNP has_VBZ been_VBN to_TO build_VB outwards_RB from_IN safety_NN ,_, adding_VBG functionality_NN while_IN adhering_JJ strictly_RB to_TO my_PRP$ principles_NNS ._.
9_CD ._.
STRINGTEMPLATE_FW StringTemplate_FW =_SYM -_: =[_NN 13_CD -RRB-_-RRB- -_: =_JJ -_: is_VBZ a_DT template_NN library_NN carefully_RB designed_VBN by_IN myself_PRP and_CC Tom_NNP Burns_NNP -LRB-_-LRB- CEO_NNP ,_, jGuru.com_NN -RRB-_-RRB- over_IN many_JJ years_NNS of_IN experience_NN building_VBG commercial_JJ sites_NNS including_VBG jGuru.com_NN ,_, knowspam.net_NN ,_, and_CC antlr.org_NN ._.
StringTempl_NN
._.
For_IN example_NN ,_, before_IN generating_VBG text_NN ,_, many_JJ source-to-source_JJ translators_NNS perform_VBP a_DT series_NN of_IN tree_NN transformations_NNS ._.
Here_RB is_VBZ a_DT template_NN for_IN an_DT assignment_NN tree_NN using_VBG -LRB-_-LRB- an_DT experimental_JJ version_NN of_IN -RRB-_-RRB- ANTLR_NN 's_POS =_JJ -_: =[_NN 14_CD -RRB-_-RRB- -_: =_JJ -_: LISP-like_JJ tree_NN notation_NN :_: #_# -LRB-_-LRB- ASSIGN_VB <ID>_FW <expr>_FW -RRB-_-RRB- where_WRB ASSIGN_NN is_VBZ a_DT literal_JJ root_NN with_IN two_CD expressions_NNS for_IN children_NNS ,_, <ID>_NN and_CC <expr>_NN ,_, whose_WP$ values_NNS are_VBP computed_VBN and_CC filled_VBN in_IN before_RB constructing_VBG the_DT tree_NN ._.
lasses_NNS of_IN templates_NNS corresponding_VBG to_TO the_DT Chomsky_NNP type_NN 1_CD ._.
.3_NN generational_JJ grammars_NNS -LRB-_-LRB- 1_LS -RRB-_-RRB- :_: contextsensitive_JJ ,_, context-free_JJ ,_, and_CC regular_JJ ._.
Let_NNP 's_POS start_NN with_IN the_DT weakest_JJS template_NN class_NN ,_, type_NN 3_CD regular_JJ grammars_NNS =_JJ -_: =[_NN 16_CD -RRB-_-RRB- -_: =_SYM -_: ._.
DEFINITION_NN 2_CD ._.
A_DT regular_JJ template_NN is_VBZ restricted_JJ to_TO 0_CD ,_, 1_CD ,_, or_CC 2_CD symbols_NNS ._.
The_DT first_JJ symbol_NN is_VBZ either_CC a_DT literal_JJ t_NN or_CC an_DT attribute_NN reference_NN a._VBP The_DT second_JJ symbol_NN ,_, if_IN present_JJ ,_, must_MD be_VB a_DT reference_NN to_TO a_DT regu_NN
f_FW context-free_FW grammars_NNS ,_, recall_VBP that_IN parsers_NNS for_IN most_JJS programming_NN languages_NNS are_VBP implemented_VBN via_IN grammars_NNS accepted_VBN by_IN LL_NN -_: and_CC LR-based_JJ parser_NN generators_NNS ,_, which_WDT are_VBP subsets_NNS of_IN the_DT context-free_JJ grammars_NNS =_JJ -_: =[_NN 17_CD -RRB-_-RRB- -_: =_SYM -_: ._.
Therefore_RB ,_, a_DT context-free_JJ template_NN is_VBZ sufficient_JJ to_TO generate_VB output_NN conforming_VBG to_TO the_DT syntax_NN of_IN common_JJ programming_NN languages_NNS ._.
Of_IN more_JJR interest_NN to_TO the_DT reader_NN is_VBZ that_IN context-free_JJ templates_NNS can_MD genera_NN
