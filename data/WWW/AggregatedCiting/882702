Defeating_VBG script_NN injection_NN attacks_NNS with_IN browser-enforced_JJ embedded_JJ policies_NNS
Web_NN sites_NNS that_WDT accept_VBP and_CC display_VBP content_NN such_JJ as_IN wiki_NN articles_NNS or_CC comments_NNS typically_RB filter_NN the_DT content_NN to_TO prevent_VB injected_VBN script_NN code_NN from_IN running_VBG in_IN browsers_NNS that_WDT view_VBP the_DT site_NN ._.
The_DT diversity_NN of_IN browser_NN rendering_VBG algorithms_NNS and_CC the_DT desire_NN to_TO allow_VB rich_JJ content_NN make_VBP filtering_VBG quite_RB difficult_JJ ,_, however_RB ,_, and_CC attacks_NNS such_JJ as_IN the_DT Samy_NNP and_CC Yamanner_NNP worms_NNS have_VBP exploited_VBN filtering_VBG weaknesses_NNS ._.
This_DT paper_NN proposes_VBZ a_DT simple_JJ alternative_JJ mechanism_NN for_IN preventing_VBG script_NN injection_NN called_VBN Browser-Enforced_NNP Embedded_VBN Policies_NNS -LRB-_-LRB- BEEP_NN -RRB-_-RRB- ._.
The_DT idea_NN is_VBZ that_IN a_DT web_NN site_NN can_MD embed_VB a_DT policy_NN in_IN its_PRP$ pages_NNS that_WDT specifies_VBZ which_WDT scripts_NNS are_VBP allowed_VBN to_TO run_VB ._.
The_DT browser_NN ,_, which_WDT knows_VBZ exactly_RB when_WRB it_PRP will_MD run_VB a_DT script_NN ,_, can_MD enforce_VB this_DT policy_NN perfectly_RB ._.
We_PRP have_VBP added_VBN BEEP_NN support_NN to_TO several_JJ browsers_NNS ,_, and_CC built_VBN tools_NNS to_TO simplify_VB adding_VBG policies_NNS to_TO web_NN applications_NNS ._.
We_PRP found_VBD that_IN supporting_VBG BEEP_NN in_IN browsers_NNS requires_VBZ only_RB small_JJ and_CC localized_JJ modifications_NNS ,_, modifying_VBG web_NN applications_NNS requires_VBZ minimal_JJ effort_NN ,_, and_CC enforcing_VBG policies_NNS is_VBZ generally_RB lightweight_JJ ._.
licious_JJ behavior_NN ._.
This_DT permits_VBZ fine-grained_JJ policies_NNS on_IN JavaScript_NNP execution_NN in_IN the_DT browser_NN ._.
However_RB ,_, the_DT work_NN does_VBZ not_RB address_VB communicating_VBG policies_NNS from_IN the_DT web_NN site_NN to_TO the_DT browser_NN ._.
Jackson_NNP et_FW al._FW =_SYM -_: =[_NN 9_CD -RRB-_-RRB- -_: =_SYM -_: describe_VBP several_JJ unexpected_JJ repositories_NNS of_IN private_JJ information_NN in_IN the_DT browser_NN 's_POS cache_NN that_WDT could_MD be_VB stolen_VBN by_IN XSS_NN attacks_NNS ._.
They_PRP advocate_VBP applying_VBG a_DT refinement_NN of_IN the_DT same-origin_JJ policy_NN -LRB-_-LRB- 28_CD -RRB-_-RRB- to_TO cover_VB
es_NNS might_MD result_VB in_IN the_DT best_JJS of_IN both_DT worlds_NNS :_: BEEP_NN would_MD accurately_RB filter_NN illegal_JJ scripts_NNS ,_, while_IN client-side_JJ rewriting_VBG could_MD police_VB server-provided_JJ scripts_NNS for_IN less-trusted_JJ sites_NNS ._.
Hallaraker_NN and_CC Vigna_NN =_JJ -_: =[_NN 7_CD -RRB-_-RRB- -_: =_SYM -_: modified_VBN Mozilla_NNP to_TO monitor_VB the_DT JavaScript_NNP operations_NNS of_IN a_DT web_NN page_NN and_CC invoke_VB countermeasures_NNS against_IN malicious_JJ behavior_NN ._.
This_DT permits_VBZ fine-grained_JJ policies_NNS on_IN JavaScript_NNP execution_NN in_IN the_DT browser_NN ._.
H_NN
dynamic_JJ content_NN ._.
Applications_NNS of_IN taint_NN checking_NN to_TO server_NN programs_NNS that_WDT generate_VBP content_NN to_TO ensure_VB that_IN untrustworthy_JJ input_NN does_VBZ not_RB flow_VB to_TO vulnerable_JJ application_NN components_NNS have_VBP also_RB been_VBN explored_VBN =_JJ -_: =[_NN 21_CD ,_, 11_CD ,_, 35_CD -RRB-_-RRB- -_: =_SYM -_: ._.
While_IN insights_NNS borrowed_VBN from_IN server-side_JJ filtering_VBG can_MD ,_, in_IN principle_NN ,_, be_VB brought_VBN to_TO bear_VB in_IN the_DT design_NN of_IN security_NN hooksfunctions_NNS ,_, our_PRP$ work_NN is_VBZ most_RBS closely_RB related_JJ to_TO other_JJ clientside_NN techniques_NNS to_TO
parse_VB and_CC render_VB wildly_RB malformed_JJ content_NN ,_, in_IN unexpected_JJ ways_NNS ._.
All_DT of_IN these_DT complications_NNS have_VBP come_VBN into_IN play_NN in_IN real_JJ attacks_NNS that_WDT have_VBP evaded_VBN server-side_JJ filtering_VBG -LRB-_-LRB- e.g._FW ,_, the_DT Samy_NNP -LRB-_-LRB- 30_CD -RRB-_-RRB- and_CC Yamanner_NN =_JJ -_: =[_NN 3_CD -RRB-_-RRB- -_: =_JJ -_: worms_NNS -RRB-_-RRB- ._.
We_PRP propose_VBP a_DT new_JJ technique_NN to_TO prevent_VB script_NN injection_NN attacks_NNS ,_, based_VBN on_IN the_DT following_JJ two_CD observations_NNS :_: Observation_NN 1_CD :_: Browsers_NNS perform_VBP perfect_JJ script_NN detection_NN ._.
If_IN a_DT browser_NN does_VBZ not_RB parse_VB
sy_NN access_NN from_IN the_DT child_NN to_TO its_PRP$ place_NN in_IN the_DT parent_NN ,_, so_RB our_PRP$ hook_NN must_MD do_VB some_DT searching_VBG in_IN the_DT parent_NN document_NN to_TO find_VB the_DT frame_NN element_NN ._.
The_DT complete_JJ implementation_NN is_VBZ available_JJ at_IN the_DT BEEP_NN web_NN site_NN =_JJ -_: =[_NN 10_CD -RRB-_-RRB- -_: =_SYM -_: ._.
3.5_CD Discussion_NN Using_VBG BEEP_NN policies_NNS ,_, the_DT web_NN site_NN and_CC the_DT browser_NN can_MD cooperate_VB to_TO provide_VB complete_JJ coverage_NN against_IN injected_VBN scripts_NNS ._.
This_DT is_VBZ because_IN -LRB-_-LRB- 1_LS -RRB-_-RRB- the_DT hook_NN function_NN implements_VBZ complete_JJ mediat_NN
._.
If_IN a_DT victim_NN follows_VBZ the_DT link_NN ,_, the_DT script_NN will_MD run_VB in_IN the_DT ``_`` not_RB found_VBN ''_'' page_NN served_VBN by_IN trusted_VBN ._.
site_NN ,_, retrieve_VBP the_DT user_NN 's_POS trusted_VBN ._.
site_NN cookie_NN ,_, and_CC send_VB it_PRP to_TO evil_NN ._.
site_NN ._.
Another_DT possible_JJ attack_NN scenario_NN =_JJ -_: =[_NN 14_CD -RRB-_-RRB- -_: =_SYM -_: exploits_VBZ the_DT dynamic_JJ Figure_NNP 2_CD :_: Ways_NNP of_IN embedding_VBG scripts_NNS in_IN web_NN pages_NNS ._.
nature_NN of_IN JavaScript-enabled_JJ web_NN pages_NNS ,_, where_WRB the_DT HTML_NNP content_NN served_VBD from_IN the_DT web_NN server_NN is_VBZ altered_VBN in_IN the_DT browser_NN by_IN the_DT execu_NN
sandboxed_JJ content_NN ,_, and_CC a_DT third_JJ to_TO output_NN the_DT hook_NN function_NN in_IN each_DT page_NN ._.
In_IN total_NN we_PRP added_VBD about_IN 40_CD lines_NNS of_IN code_NN ,_, plus_CC the_DT 34-line_JJ hook_NN function_NN ._.
We_PRP also_RB enlisted_VBD the_DT aid_NN of_IN the_DT authors_NNS of_IN Continue_NN =_JJ -_: =[_NN 15_CD -RRB-_-RRB- -_: =_JJ -_: ,_, a_DT web_NN application_NN for_IN managing_VBG conferences_NNS ;_: they_PRP added_VBD DOM_NNP sandboxing_VBG to_TO Continue_NNP in_IN 10_CD lines_NNS of_IN code_NN ._.
It_PRP should_MD be_VB just_RB as_RB easy_JJ to_TO modify_VB a_DT web_NN application_NN written_VBN in_IN a_DT templating_VBG language_NN such_JJ as_IN
it_PRP in_IN the_DT whitelist_NN ,_, or_CC outside_IN any_DT sandbox_NN ._.
However_RB ,_, blindly_RB trusting_VBG this_DT third-party_JJ script_NN is_VBZ not_RB without_IN risk_NN :_: the_DT script_NN may_MD actually_RB be_VB malicious_JJ ,_, e.g._FW ,_, part_NN of_IN a_DT scheme_NN to_TO perform_VB clickfraud_NN =_JJ -_: =[_NN 5_CD -RRB-_-RRB- -_: =_SYM -_: ._.
BEEP_NN does_VBZ not_RB provide_VB any_DT guidance_NN on_IN whether_IN to_TO trust_VB a_DT third_JJ party_NN ._.
Scripts_NNS can_MD also_RB dynamically_RB create_VB new_JJ scripts_NNS and_CC insert_VB them_PRP into_IN the_DT page_NN using_VBG DOM_NNP operations_NNS ;_: e.g._FW ,_, some_DT ads_NNS are_VBP implement_VB
think_VB a_DT packet_NN is_VBZ harmless_JJ because_IN it_PRP is_VBZ ill-formed_JJ ,_, but_CC in_IN fact_NN a_DT particular_JJ OS_NN might_MD accept_VB it_PRP and_CC thereby_RB be_VB exploited_VBN ._.
Our_PRP$ solution_NN is_VBZ analogous_JJ to_TO a_DT host-based_JJ intrusion_NN detection_NN system_NN -LRB-_-LRB- HBIDS_NN -RRB-_-RRB- =_JJ -_: =[_NN 34_CD ,_, 4_CD -RRB-_-RRB- -_: =_SYM -_: ._.
In_IN these_DT systems_NNS ,_, a_DT program_NN 's_POS correct_JJ behavior_NN is_VBZ characterized_VBN in_IN advance_NN in_IN terms_NNS of_IN actions_NNS like_IN system_NN calls_NNS ,_, and_CC an_DT execution_NN monitor_NN detects_VBZ when_WRB a_DT program_NN deviates_VBZ from_IN its_PRP$ allowable_JJ behavior_NN
ring_NN can_MD ,_, in_IN principle_NN ,_, be_VB brought_VBN to_TO bear_VB in_IN the_DT design_NN of_IN security_NN hooksfunctions_NNS ,_, our_PRP$ work_NN is_VBZ most_RBS closely_RB related_JJ to_TO other_JJ clientside_NN techniques_NNS to_TO protect_VB users_NNS from_IN malicious_JJ web_NN content_NN ._.
Noxes_NNS =_JJ -_: =[_NN 13_CD -RRB-_-RRB- -_: =_JJ -_: is_VBZ a_DT purely_RB client-side_JJ method_NN that_WDT aims_VBZ to_TO defend_VB against_IN cross-site_JJ scripting_NN by_IN disallowing_VBG the_DT browser_NN from_IN contacting_VBG ``_`` bad_JJ ''_'' URLs_NNS ._.
It_PRP has_VBZ general_JJ rules_NNS for_IN blacklisting_NN and_CC whitelisting_VBG web_NN sites_NNS
