Detection_NN and_CC analysis_NN of_IN drive-by-download_NN attacks_NNS and_CC malicious_JJ JavaScript_NN code_NN
JavaScript_NNP is_VBZ a_DT browser_NN scripting_VBG language_NN that_WDT allows_VBZ developers_NNS to_TO create_VB sophisticated_JJ client-side_JJ interfaces_NNS for_IN web_NN applications_NNS ._.
However_RB ,_, JavaScript_NN code_NN is_VBZ also_RB used_VBN to_TO carry_VB out_RP attacks_NNS against_IN the_DT user_NN 's_POS browser_NN and_CC its_PRP$ extensions_NNS ._.
These_DT attacks_NNS usually_RB result_VBP in_IN the_DT download_NN of_IN additional_JJ malware_NN that_WDT takes_VBZ complete_JJ control_NN of_IN the_DT victim_NN 's_POS platform_NN ,_, and_CC are_VBP ,_, therefore_RB ,_, called_VBN ``_`` drive-by_JJ downloads_NNS ._. ''_''
Unfortunately_RB ,_, the_DT dynamic_JJ nature_NN of_IN the_DT JavaScript_NNP language_NN and_CC its_PRP$ tight_JJ integration_NN with_IN the_DT browser_NN make_VBP it_PRP difficult_JJ to_TO detect_VB and_CC block_VB malicious_JJ JavaScript_NNP code_NN ._.
This_DT paper_NN presents_VBZ a_DT novel_JJ approach_NN to_TO the_DT detection_NN and_CC analysis_NN of_IN malicious_JJ JavaScript_NNP code_NN ._.
Our_PRP$ approach_NN combines_VBZ anomaly_RB detection_NN with_IN emulation_NN to_TO automatically_RB identify_VB malicious_JJ JavaScript_NNP code_NN and_CC to_TO support_VB its_PRP$ analysis_NN ._.
We_PRP developed_VBD a_DT system_NN that_WDT uses_VBZ a_DT number_NN of_IN features_NNS and_CC machine-learning_JJ techniques_NNS to_TO establish_VB the_DT characteristics_NNS of_IN normal_JJ JavaScript_NNP code_NN ._.
Then_RB ,_, during_IN detection_NN ,_, the_DT system_NN is_VBZ able_JJ to_TO identify_VB anomalous_JJ JavaScript_NNP code_NN by_IN emulating_VBG its_PRP$ behavior_NN and_CC comparing_VBG it_PRP to_TO the_DT established_JJ profiles_NNS ._.
In_IN addition_NN to_TO identifying_VBG malicious_JJ code_NN ,_, the_DT system_NN is_VBZ able_JJ to_TO support_VB the_DT analysis_NN of_IN obfuscated_VBN code_NN and_CC to_TO generate_VB detection_NN signatures_NNS for_IN signature-based_JJ systems_NNS ._.
The_DT system_NN has_VBZ been_VBN made_VBN publicly_RB available_JJ and_CC has_VBZ been_VBN used_VBN by_IN thousands_NNS of_IN analysts_NNS ._.
threats_NNS for_IN which_WDT publishers_NNS can_MD readily_RB deploy_VB strong_JJ protection_NN -LRB-_-LRB- e.g._FW ,_, cross-site_JJ request_NN forgeries_NNS -RRB-_-RRB- ._.
1_CD ._.
Browser_NN security_NN bugs_NNS ._.
We_PRP do_VBP not_RB address_VB browser_NN vulnerabilities_NNS such_JJ as_IN drive-by-downloads_NN =_JJ -_: =[_NN 49_CD ,_, 36_CD ,_, 5_CD -RRB-_-RRB- -_: =_JJ -_: ,_, attacks_NNS launched_VBN through_IN plug-ins_NNS -LRB-_-LRB- 24_CD -RRB-_-RRB- ,_, vulnerabilities_NNS in_IN image_NN rendering_NN -LRB-_-LRB- 23_CD -RRB-_-RRB- and_CC so_RB on_RB ._.
32_CD ._.
Opaque_JJ content_NN ._.
Our_PRP$ approach_NN leverages_VBZ web_NN content_NN introspection_NN capabilities_NNS of_IN JavaScript_NNP ,_, and_CC is_VBZ th_DT
it_PRP detection_NN and_CC mitigation_NN -LRB-_-LRB- 15_CD ,_, 7_CD ,_, 6_CD -RRB-_-RRB- ._.
However_RB ,_, all_PDT this_DT related_JJ work_NN focus_NN on_IN techniques_NNS to_TO detect_VB the_DT operating_NN system_NN level_NN ._.
Additionally_RB ,_, some_DT work_NN that_WDT tries_VBZ to_TO detect_VB drive-by-download_NN attacks_NN =_JJ -_: =[_NN 5_CD -RRB-_-RRB- -_: =_SYM -_: uses_VBZ anomaly_RB detection_NN with_IN emulation_NN to_TO automatically_RB identify_VB malicious_JJ JavaScript_NNP code_NN ._.
Virtual_JJ Container_NNP Wine_NNP Internet_NNP Explorer_NNP Custom_NNP Wine_NNP memory_NN allocator_NN NOP_NNP Sled_NNP Detector_NNP Scan_VB memory_NN with_IN :_: No_DT
tinfected_JJ sites_NNS ._.
We_PRP found_VBD no_DT site_NN from_IN these_DT sources_NNS that_WDT was_VBD not_RB also_RB present_JJ in_IN the_DT data_NNS we_PRP collected_VBD ._.
We_PRP also_RB removed_VBD invalid_JJ URLs_NNS and_CC used_VBD Wepawet_NNP ,_, our_PRP$ tool_NN to_TO detect_VB and_CC analyze_VB webbased_JJ malware_NN =_JJ -_: =[_NN 3_CD -RRB-_-RRB- -_: =_JJ -_: ,_, to_TO discard_VB URLs_NNS that_WDT were_VBD not_RB infected_JJ ._.
Prevalence_NN and_CC Distribution_NN of_IN Infected_JJ Sites_NNS ._.
In_IN total_NN ,_, we_PRP received_VBD 381,768_CD requests_NNS that_WDT were_VBD Mebroot-compatible_JJ and_CC that_WDT specified_VBD a_DT referring_VBG page_NN -LRB-_-LRB- contai_NN
y_NN unseen_JJ attacks_NNS ,_, or_CC those_DT that_WDT do_VBP not_RB involve_VB ActiveX_NN components_NNS ,_, which_WDT ZOZZLE_NNP is_VBZ able_JJ to_TO detect_VB ._.
Cova_NNP et_FW al._FW present_VBP a_DT system_NN JSAND_NN that_WDT conducts_VBZ classification_NN based_VBN on_IN static_JJ and_CC dynamic_JJ features_NNS =_JJ -_: =[_NN 10_CD -RRB-_-RRB- -_: =_SYM -_: ._.
In_IN this_DT system_NN ,_, potentially_RB malicious_JJ JavaScript_NNP is_VBZ emulated_VBN to_TO determine_VB runtime_NN characteristics_NNS around_IN deobfuscation_NN ,_, environment_NN preparation_NN ,_, and_CC exploitation_NN ,_, such_JJ as_IN the_DT number_NN of_IN bytes_NNS allocat_NN
utes_NNS ._.
In_IN addition_NN to_TO high-interaction_JJ honeyclients_NNS ,_, researchers_NNS have_VBP proposed_VBN alternative_JJ detection_NN approaches_NNS for_IN malicious_JJ web_NN pages_NNS ._.
In_IN particular_JJ ,_, a_DT number_NN of_IN tools_NNS were_VBD proposed_VBN -LRB-_-LRB- such_JJ as_IN Wepawet_NN =_JJ -_: =[_NN 4_CD -RRB-_-RRB- -_: =_JJ -_: ,_, PhoneyC_NN -LRB-_-LRB- 20_CD -RRB-_-RRB- ,_, JSUnpack_NN -LRB-_-LRB- 15_CD -RRB-_-RRB- -RRB-_-RRB- that_WDT rely_VBP on_IN instrumented_JJ JavaScript_NNP run-time_NN environments_NNS to_TO detect_VB the_DT execution_NN of_IN malicious_JJ scripts_NNS ,_, or_CC only_RB a_DT certain_JJ kind_NN of_IN attacks_NNS -LRB-_-LRB- such_JJ as_IN NOZZLE_NN -LRB-_-LRB- 23_CD -RRB-_-RRB- ,_, a_DT tool_NN f_SYM
if_IN desired_VBN ._.
The_DT implementation_NN of_IN the_DT avatar_NN provides_VBZ the_DT additional_JJ benefit_NN of_IN being_VBG a_DT funnel_VB for_IN SPAM_NNP ,_, Data_NNP Loss_NN and_CC Antivirus_NN protection_NN and_CC can_MD act_VB as_IN a_DT sensor_NN for_IN new_JJ JavaScript_NNP malware_NN analysis_NN =_JJ -_: =[_NN 10_CD -RRB-_-RRB- -_: =_SYM -_: ._.
A._FW Overview_FW The_DT privacy_NN avatar_NN is_VBZ implemented_VBN as_IN a_DT C_NN #_# ,_, ._.
NET_NN multi-threaded_JJ transparent_JJ proxy_NN ,_, which_WDT provides_VBZ the_DT ability_NN to_TO intercept_VB ,_, inspect_VB and_CC impersonate_VB social_JJ network_NN communication_NN ._.
This_DT over_IN
bution_NN network_NN -LRB-_-LRB- MDN_NN -RRB-_-RRB- ._.
In_IN this_DT paper_NN ,_, we_PRP define_VBP a_DT MDN_NN to_TO be_VB a_DT collection_NN of_IN drive-by_JJ downloads_NNS that_WDT serve_VBP the_DT same_JJ malicious_JJ objective_NN such_JJ as_IN distributing_VBG related_JJ malware_NN executables_NNS ._.
Several_JJ methods_NNS =_JJ -_: =[_NN 2_CD ,_, 6_CD ,_, 8_CD ,_, 9_CD ,_, 10_CD ,_, 20_CD -RRB-_-RRB- -_: =_SYM -_: have_VBP been_VBN proposed_VBN to_TO detect_VB drive-by_JJ download_NN attacks_NNS and_CC are_VBP described_VBN in_IN detail_NN in_IN Section_NN 2_CD ._.
Most_JJS of_IN these_DT methods_NNS -LRB-_-LRB- 2_CD ,_, 6_CD ,_, 9_CD ,_, 10_CD ,_, 20_CD -RRB-_-RRB- depend_VBP on_IN the_DT malicious_JJ webpage_NN content_NN returned_VBN by_IN servers_NNS us_PRP
has_VBZ never_RB been_VBN studied_VBN before_RB ._.
Techniques_NNS to_TO identify_VB drive-by-download_NN attacks_NNS have_VBP been_VBN proposed_VBN that_WDT analyze_VBP web_NN sites_NNS for_IN malicious_JJ content_NN in_IN a_DT virtual_JJ or_CC emulated_VBN environment_NN to_TO detect_VB exploits_NNS =_JJ -_: =[_NN 5_CD ,_, 14_CD -RRB-_-RRB- -_: =_SYM -_: ._.
The_DT prevalence_NN of_IN malicious_JJ web_NN sites_NNS hasbeen_VBP examined_VBN through_IN crawler-based_JJ approaches_NNS that_WDT analyzed_VBD billions_NNS of_IN web_NN pages_NNS -LRB-_-LRB- 28_CD ,_, 29_CD -RRB-_-RRB- ._.
Another_DT study_NN analyzed_VBD drive-by_JJ attacks_NNS via_IN infiltration_NN and_CC pr_NN
es_NNS analyzed_VBN by_IN Sophos_NNP Labs_NNPS every_DT day_NN in_IN 2010_CD ,_, about_IN 95,000_CD samples_NNS ,_, nearly_RB doubled_VBD from_IN 2009_CD -LRB-_-LRB- 31_CD -RRB-_-RRB- ._.
While_IN static_JJ and_CC runtime_JJ methods_NNS for_IN malware_NN detection_NN have_VBP been_VBN proposed_VBN in_IN the_DT research_NN literature_NN =_JJ -_: =[_NN 11_CD ,_, 12_CD ,_, 26_CD -RRB-_-RRB- -_: =_JJ -_: ,_, both_DT on_IN the_DT client_NN side_NN ,_, for_IN just-in-time_JJ in-browser_JJ detection_NN ,_, as_RB well_RB as_IN offline_JJ ,_, crawler-based_JJ malware_NN discovery_NN ,_, these_DT approaches_NNS encounter_VBP the_DT same_JJ fundamental_JJ limitation_NN ._.
Web-based_JJ malware_NN ten_CD
ns_NNS of_IN web_NN pages_NNS today_NN contain_VBP malicious_JJ JavaScript_NNP that_WDT attempts_VBZ to_TO take_VB over_RP a_DT victim_NN 's_POS web_NN browser_NN ._.
An_DT active_JJ research_NN literature_NN has_VBZ proposed_VBN static_JJ and_CC dynamic_JJ methods_NNS for_IN detecting_VBG these_DT attacks_NNS =_JJ -_: =[_NN 40_CD ,_, 13_CD ,_, 11_CD ,_, 9_CD -RRB-_-RRB- -_: =_SYM -_: ._.
A_DT key_JJ finding_NN of_IN this_DT work_NN is_VBZ that_IN malware_NN authors_NNS use_VBP fingerprinting_VBG techniques_NNS -LRB-_-LRB- 35_CD ,_, 16_CD -RRB-_-RRB- to_TO decide_VB which_WDT malware_NN to_TO deliver_VB to_TO the_DT victim_NN user_NN ._.
Figure_NN 9_CD shows_VBZ an_DT example_NN of_IN client-side_JJ browser_NN fin1_NN
Millions_NNS of_IN web_NN pages_NNS today_NN contain_VBP malicious_JJ JavaScript_NNP that_WDT attempts_VBZ to_TO take_VB over_RP a_DT victim_NN 's_POS web_NN browser_NN ._.
An_DT active_JJ researchliteraturehasproposedstatic_JJ anddynamicmethods_NNS for_IN detecting_VBG these_DT attacks_NNS =_JJ -_: =[_NN 9_CD ,_, 11_CD ,_, 13_CD ,_, 41_CD -RRB-_-RRB- -_: =_SYM -_: ._.
A_DT key_JJ finding_NN of_IN this_DT work_NN is_VBZ that_IN malware_NN authors_NNS use_VBP fingerprinting_VBG techniques_NNS -LRB-_-LRB- 17_CD ,_, 36_CD -RRB-_-RRB- to_TO decide_VB which_WDT malware_NN to_TO deliver_VB to_TO the_DT victim_NN user_NN ._.
Figure_NN 9_CD shows_VBZ an_DT example_NN of_IN client-side_JJ browser_NN fing_NN
ause_VB they_PRP are_VBP designed_VBN for_IN server-exploiting_JJ malware_NN ._.
Al-though_JJ client-side_JJ honeypot_NN techniques_NNS such_JJ as_IN CaptureHPC_NN -LRB-_-LRB- 1_CD -RRB-_-RRB- and_CC HoneyMonkey_NN -LRB-_-LRB- 18_CD -RRB-_-RRB- ,_, and_CC suspicious_JJ web_NN content_NN analysis_NN service_NN such_JJ as_IN Wepawet_NN =_JJ -_: =[_NN 6_CD ,_, 9_CD -RRB-_-RRB- -_: =_SYM -_: are_VBP proposed_VBN ,_, their_PRP$ main_JJ purpose_NN is_VBZ to_TO detect_VB whether_IN a_DT given_VBN URL\/Flash_NN file_NN is_VBZ malicious_JJ or_CC not_RB ,_, instead_RB of_IN to_TO collect_VB the_DT complete_JJ malicious_JJ logic_NN and_CC infection_NN trails_VBZ in_IN web-based_JJ malware_NN ._.
Current_NNP
lutions_NNS relying_VBG on_IN exposing_VBG sandboxed_JJ browsers_NNS to_TO potentially_RB malicious_JJ content_NN -LRB-_-LRB- 54_CD -RRB-_-RRB- ,_, -LRB-_-LRB- 55_CD -RRB-_-RRB- ._.
An_DT exception_NN is_VBZ Wepawet_NNP ,_, which_WDT relies_VBZ on_IN detecting_VBG anomalous_JJ arguments_NNS passed_VBN to_TO plugins_NNS to_TO prevent_VB attacks_NN =_JJ -_: =[_NN 56_CD -RRB-_-RRB- -_: =_SYM -_: ._.
Our_PRP$ own_JJ system_NN generalizes_VBZ to_TO all_DT forms_NNS of_IN scams_NNS ,_, phishing_NN ,_, and_CC malware_NN and_CC allows_VBZ for_IN real-time_JJ URL_NN submission_NN by_IN web_NN services_NNS ._.
Of_IN the_DT closest_JJS works_NNS to_TO our_PRP$ own_JJ ,_, Ma_NNP et_FW al._FW show_VBP that_IN one_PRP can_MD classify_VB
runtime_NN heuristics_NNS ._.
Besides_IN the_DT detection_NN of_IN code_NN injection_NN attacks_NNS at_IN the_DT network_NN level_NN -LRB-_-LRB- 13_CD --_: 15_CD ,_, 18_CD ,_, 25_CD -RRB-_-RRB- ,_, shellcode_NN identification_NN has_VBZ been_VBN used_VBN for_IN in-browser_JJ detection_NN of_IN drive-by_JJ download_NN attacks_NN =_JJ -_: =[_NN 8,9_CD -RRB-_-RRB- -_: =_JJ -_: ,_, as_RB well_RB as_IN malicious_JJ document_NN scanning_NN -LRB-_-LRB- 18_CD ,_, 22_CD -RRB-_-RRB- ._.
In_IN a_DT ROP_NN exploit_VB ,_, however_RB ,_, in_IN place_NN of_IN the_DT shellcode_NN ,_, the_DT attack_NN vector_NN contains_VBZ just_RB a_DT chunk_NN of_IN data_NNS --_: to_TO which_WDT we_PRP refer_VBP as_IN the_DT ROP_NNP payload_NN --_: comprising_VBG
less_JJR of_IN the_DT AVs_NNS ,_, while_IN 24_CD samples_NNS were_VBD detected_VBN by_IN 20_CD %_NN or_CC less_JJR ._.
Even_RB for_IN the_DT most_JJS detectablesamples_NNS ,_, therewereabout20_CD %_NN ormoreoftheAVs_NN that_WDT did_VBD not_RB detect_VB them_PRP ._.
We_PRP also_RB submitted_VBD all_DT samples_NNS to_TO Wepawet_NNP =_SYM -_: =[_NN 11,15_CD -RRB-_-RRB- -_: =_JJ -_: ,_, which_WDT reported_VBD 119_CD files_NNS as_IN malicious_JJ ,_, 16_CD as_IN suspicious_JJ ,_, 58_CD as_IN benign_JJ ,_, while_IN four_CD resulted_VBD to_TO error_NN ._.
Cumulative_JJ fraction_NN of_IN PDF_NN files_NNS 1_CD 0.8_CD 0.6_CD 0.4_CD 0.2_CD 0_CD Benign_JJ Malicious_JJ 0_CD 5_CD 10_CD 15_CD 20_CD 25_CD Processing_NN
e_LS 's_POS window_NN ._.
location_NN property_NN makes_VBZ the_DT frame_NN navigate_VB to_TO a_DT new_JJ site_NN ._.
If_IN a_DT frame_NN loads_NNS a_DT malicious_JJ third_JJ party_NN script_NN ,_, the_DT script_NN can_MD manipulate_VB window_NN ._.
location_NN to_TO trick_NN users_NNS into_IN downloading_VBG malware_NN =_JJ -_: =[_NN 8_CD -RRB-_-RRB- -_: =_SYM -_: ._.
To_TO prevent_VB this_DT ,_, we_PRP place_VBP a_DT setter_NN on_IN window_NN ._.
location_NN that_WDT either_RB prevents_VBZ all_DT assignments_NNS ,_, or_CC only_RB allows_VBZ assignments_NNS if_IN the_DT target_NN URL_NN is_VBZ in_IN a_DT whitelist_NN ._.
Implementing_VBG these_DT extensions_NNS on_IN Atlantis_NNP
ther_JJ hand_NN ,_, is_VBZ designed_VBN to_TO work_VB with_IN general_JJ code_NN mashup_NN applications_NNS ._.
Finally_RB ,_, it_PRP should_MD be_VB noted_VBN that_IN in_IN the_DT realm_NN of_IN web_NN security_NN much_JJ work_NN has_VBZ been_VBN done_VBN to_TO understand_VB the_DT Web-based_JJ malware_NN problem_NN =_JJ -_: =[_NN 3_CD ,_, 18_CD ,_, 19_CD ,_, 20_CD -RRB-_-RRB- -_: =_SYM -_: ._.
However_RB ,_, these_DT address_NN issues_NNS orthogonal_JJ to_TO our_PRP$ work_NN on_IN mashups_NNS ,_, where_WRB the_DT focus_NN is_VBZ on_IN protecting_VBG against_IN the_DT trust_NN issues_NNS that_IN this_DT programming_NN paradigm_NN might_MD introduce_VB ._.
6_CD ._.
CONCLUSION_NN In_IN this_DT paper_NN
features_NNS of_IN the_DT JavaScriptAST_NN -LRB-_-LRB- abstract_JJ syntax_NN tree_NN -RRB-_-RRB- ._.
We_PRP train_VBP the_DT classifier_NN with_IN a_DT collection_NN of_IN labeled_JJ malware_NN samples_NNS collected_VBN with_IN the_DT NOZZLE_NN dynamic_JJ heap-spraying_JJ detector_NN -LRB-_-LRB- 21_CD -RRB-_-RRB- ._.
Related_JJ work_NN =_JJ -_: =[_NN 4_CD ,_, 6_CD ,_, 14_CD ,_, 22_CD -RRB-_-RRB- -_: =_SYM -_: also_RB classifies_VBZ JavaScript_NNP malware_NN using_VBG a_DT combination_NN of_IN static_JJ and_CC dynamic_JJ features_NNS ,_, but_CC relies_VBZ on_IN emulation_NN to_TO deobfuscate_VB the_DT code_NN and_CC to_TO observe_VB dynamic_JJ features_NNS ._.
Because_IN we_PRP avoid_VBP emulation_NN ,_, our_PRP$
e._VBN However_RB ,_, the_DT expressiveness_NN of_IN JavaScript_NNP is_VBZ often_RB misused_VBN by_IN attackers_NNS to_TO create_VB obfuscated_VBN malware_NN ,_, which_WDT has_VBZ led_VBN to_TO research_NN in_IN trying_VBG to_TO detect_VB malware_NN using_VBG both_CC static_JJ and_CC runtime_NN techniques_NNS =_JJ -_: =[_NN 1_CD ,_, 3_CD ,_, 5_CD ,_, 8_CD ,_, 10_CD ,_, 21_CD -RRB-_-RRB- -_: =_SYM -_: ._.
Of_IN course_NN ,_, there_EX is_VBZ plenty_NN of_IN benign_JJ code_NN that_WDT has_VBZ been_VBN obfuscated_VBN ,_, often_RB as_IN a_DT light_JJ form_NN of_IN intellectual_JJ property_NN protection_NN ,_, by_IN toolkits_NNS such_JJ as_IN JavaScript_NNP Obfuscator_NNP -LRB-_-LRB- 15_CD -RRB-_-RRB- ._.
In_IN many_JJ contexts_NNS ,_, it_PRP is_VBZ
ttacks_NNS have_VBP not_RB received_VBN significant_JJ attention_NN in_IN the_DT research_NN community_NN so_RB far_RB ._.
Previous_JJ work_NN in_IN this_DT field_NN has_VBZ mostly_RB focused_VBN on_IN dynamic_JJ analysis_NN techniques_NNS ._.
For_IN example_NN ,_, well-known_JJ sandboxes_NNS JSand_NN =_JJ -_: =[_NN 7_CD -RRB-_-RRB- -_: =_JJ -_: and_CC CWSandbox_NN -LRB-_-LRB- 26_CD -RRB-_-RRB- have_VBP been_VBN adapted_VBN to_TO the_DT analysis_NN of_IN malicious_JJ PDF_NN documents_NNS ._.
Due_JJ to_TO their_PRP$ heavy_JJ instrumentation_NN and_CC security_NN risks_NNS associated_VBN with_IN dynamic_JJ analysis_NN ,_, the_DT practical_JJ applicability_NN of_IN
